import { Elysia } from 'elysia';
export const bearer = ({ extract: { body = 'access_token', query = 'access_token', header = 'Bearer' } = {
    body: 'access_token',
    query: 'access_token',
    header: 'Bearer'
} } = {
    extract: {
        body: 'access_token',
        query: 'access_token',
        header: 'Bearer'
    }
}) => new Elysia({
    name: '@elysiajs/bearer',
    seed: {
        body,
        query,
        header
    }
}).derive(({ query: queries, headers: { authorization } }) => ({
    get bearer() {
        if (authorization?.startsWith(header))
            return authorization.slice(header.length + 1);
        const q = queries[query];
        if (q)
            return q;
    }
}));
export default bearer;
